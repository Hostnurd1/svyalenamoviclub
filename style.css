:root {
  /* Палитра — только основные цвета */
  --color-bg: #f6f8fa;
  --color-bg-soft: #f2f7fe;
  --color-primary: #4257e2;
  --color-primary-dark: #2e40a2;
  --color-accent: #fb3640;
  --color-accent-light: #ffd26c;
  --color-neutral: #e6ecfd;
  --color-border: #e1e6f9;
  --color-text: #172039;
  --color-muted: #7683a4;

  /* Градиенты */
  --gradient-primary: linear-gradient(98deg, #4257e2 60%, #9573fa 100%);
  --gradient-accent: linear-gradient(94deg,#fb3640 65%,#ffd26c 100%);
}

body {
  background: var(--color-bg);
  color: var(--color-text);
}

/* Для главной кнопки и активной вкладки использовать var(--gradient-primary) */
button.primary, .tab.active, .random-btn {
  background: var(--gradient-primary);
  color: #fff;
  font-weight: 700;
  box-shadow: 0 4px 14px #4257e216;
}
button.primary:hover, .tab.active:hover, .random-btn:hover {
  background: var(--color-primary-dark);
}
:root {
  --space: 4px;
}

/* Весь вертикальный ритм кратен 4px! */
.container {
  padding: calc(var(--space) * 9) calc(var(--space) * 6) calc(var(--space) * 11) calc(var(--space) * 6);
  border-radius: calc(var(--space) * 9);
  box-shadow: 0 calc(var(--space) * 2.5) calc(var(--space) * 10) #4257e21a;
  margin-top: calc(var(--space) * 10);
  background: #fff;
}

/* Карточки фильмов */
.movie-list {
  list-style: none;
  padding: 0;
  margin: 0;
}
.movie {
  margin-bottom: calc(var(--space) * 6);
  padding: calc(var(--space) * 4) calc(var(--space) * 3);
  border-radius: calc(var(--space) * 3.5);
  background: var(--color-bg-soft);
  box-shadow: 0 calc(var(--space) * 1.5) calc(var(--space) * 3) #4257e20c;
  border: 1.5px solid var(--color-border);
  min-height: 60px;
  transition: box-shadow .14s;
}
.movie:not(:last-child) { margin-bottom: calc(var(--space) * 6); }

.movie-title {
  font-size: 20px;
  font-weight: 800;
  margin-bottom: calc(var(--space) * 1.5);
  color: var(--color-primary-dark);
  letter-spacing: .2px;
}
.mini {
  font-size: 13px;
  color: var(--color-muted);
  margin-bottom: calc(var(--space) * 1);
  display: inline-block;
}

.user-block {
  margin-bottom: calc(var(--space) * 2.5);
  margin-top: calc(var(--space) * 2.5);
  border-radius: calc(var(--space) * 2.5);
  padding: calc(var(--space) * 2) calc(var(--space) * 2.5) calc(var(--space) * 2.5) calc(var(--space) * 2.5);
  background: #f6f8ff;
}
.user-svyat { border-left: 3.5px solid #4d75ee; }
.user-alena { border-left: 3.5px solid #fb72ce; }
.user-block b {
  font-weight: 700;
  color: #3d4376;
  font-size: 16px;
  margin-bottom: 3px;
}

/* Табы, фильтры, поиск — всегда кратно 4px, gap между кнопками */
.nav-tabs, .filters {
  gap: calc(var(--space) * 2.5);
  margin: calc(var(--space) * 2) 0;
}

.tab, .filter-btn {
  padding: calc(var(--space) * 2) calc(var(--space) * 5);
  border-radius: calc(var(--space) * 2.5);
  font-size: 16px;
  font-weight: 600;
}
.tab.active {
  background: var(--gradient-primary);
  color: #fff;
  border-bottom: 3px solid var(--color-accent-light);
}
.tab:not(.active) {
  background: var(--color-neutral);
  color: var(--color-primary-dark);
}
.filter-btn.active {
  background: var(--gradient-accent);
  color: #fff;
}
:root {
  --font-body: 14px;
  --font-subtitle: 18px;
  --font-title: 22px;
  --font-heading: 24px;
  --letter-space: 0.2px;
}

body {
  font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
  font-size: var(--font-body);
  letter-spacing: var(--letter-space);
  background: var(--color-bg);
  color: var(--color-text);
}

h1, .main-title {
  font-size: var(--font-heading);
  font-weight: 800;
  letter-spacing: var(--letter-space);
  margin-bottom: 20px;
}

.movie-title {
  font-size: var(--font-title);
  font-weight: 800;
  letter-spacing: var(--letter-space);
}

.subtitle, .nav-tabs .tab, .filter-btn, .add-movie button {
  font-size: var(--font-subtitle);
  font-weight: 600;
  letter-spacing: var(--letter-space);
}

.user-block b,
.avg-score {
  font-size: 16px;
  font-weight: 600;
}

.mini, .version, .important-note {
  font-size: 13px;
  letter-spacing: var(--letter-space);
}

input, textarea {
  font-size: var(--font-body);
  font-family: inherit;
  letter-spacing: var(--letter-space);
  font-weight: 400;
}

button, .modal-btn, .random-btn, .switch-btn, .filter-btn, .tab {
  font-weight: 500;
}

/* Разрешить системное увеличение текста и не запрещать scaling */
html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}
/* --- Порядок и структура карточки фильма --- */
.movie {
  display: flex;
  flex-direction: column;
  gap: calc(var(--space) * 2.5);
  box-sizing: border-box;
  padding: calc(var(--space) * 4) calc(var(--space) * 3) calc(var(--space) * 4) calc(var(--space) * 3);
}

/* Верх карточки: название → год → статус (рядом, но компактно) */
.movie-header {
  display: flex;
  align-items: baseline;
  gap: calc(var(--space) * 2);
  margin-bottom: calc(var(--space) * 1.5);
}
.movie-title {
  flex-shrink: 1;
}
.movie-year {
  color: var(--color-muted);
  font-size: 15px;
  margin-left: 4px;
}
.movie-status {
  color: var(--color-accent);
  font-weight: 500;
  font-size: 15px;
  margin-left: 12px;
  background: #fff2e6;
  border-radius: 8px;
  padding: 2px 10px;
}

/* --- Оценка и смайлик в одну линию, потом комментарий ниже --- */
.user-row {
  display: flex;
  align-items: center;
  gap: calc(var(--space) * 3);
  margin-bottom: calc(var(--space) * 2);
}
.user-block {
  margin-bottom: calc(var(--space) * 1.5);
  padding: calc(var(--space) * 1.5) calc(var(--space) * 2.5);
  border-radius: calc(var(--space) * 2);
  background: #f6f8ff;
  box-sizing: border-box;
  gap: 0;
}
.user-svyat { border-left: 3px solid #4d75ee; background: #f6f9ff; }
.user-alena { border-left: 3px solid #fb72ce; background: #fff6fb; }
.user-label {
  font-weight: 500;
  color: var(--color-primary);
  font-size: 15px;
  min-width: 38px;
  margin-right: 7px;
}

/* Оценка — крупнее и жирнее, смайлик ближе, коммент всегда снизу! */
.user-block input[type="number"] {
  width: 38px;
  text-align: center;
  font-size: 18px;
  font-weight: 600;
  margin-right: 7px;
}
.user-block input[type="text"][maxlength="2"] {
  width: 36px;
  text-align: center;
  font-size: 20px;
  background: #f5f7fd;
  margin-right: 10px;
  letter-spacing: .3px;
}

/* Комментарий — textarea или div, всегда под оценкой! */
.user-block textarea {
  width: 100%;
  margin-top: 2px;
  margin-bottom: 0;
  min-height: 36px;
  font-size: 14px;
  line-height: 1.4;
}

/* Кнопка "Подтвердить" — маленькая, под комментом, по центру */
.user-block .confirm-btn {
  display: block;
  margin: 8px auto 0 auto;
  font-size: 15px;
  padding: 8px 20px;
  background: var(--gradient-primary);
  border-radius: 7px;
  box-shadow: 0 1px 5px #4257e213;
}
.user-block .confirm-btn[disabled] {
  background: #e6ecfd;
  color: #bbb;
}

/* --- Средняя оценка — сжатый жёлтый лейбл справа снизу карточки --- */
.avg-score {
  background: var(--color-accent-light);
  color: #695900;
  border-radius: 7px;
  padding: 2px 11px;
  display: inline-block;
  font-weight: 700;
  font-size: 15px;
  margin-top: 10px;
  float: right;
  box-shadow: 0 1px 3px #ffe59d50;
}

/* Отступы между блоками */
.movie-list {
  margin-top: calc(var(--space) * 7);
}
.filters-search {
  margin-bottom: calc(var(--space) * 7);
}
.add-movie {
  margin-bottom: calc(var(--space) * 7);
}
/* --- Кнопки и интерактивные зоны --- */
button, .modal-btn, .random-btn, .switch-btn, .filter-btn, .tab {
  min-width: 44px;
  min-height: 44px;
  touch-action: manipulation;
  border: none;
  cursor: pointer;
  transition: background .16s, transform .1s, box-shadow .13s;
  outline: none;
  user-select: none;
}
button:active, .modal-btn:active, .random-btn:active, .switch-btn:active, .filter-btn:active, .tab:active {
  transform: scale(0.97);
  box-shadow: 0 2px 10px #4257e230;
  background-blend-mode: multiply;
}
button:focus-visible, .tab:focus-visible, .filter-btn:focus-visible {
  box-shadow: 0 0 0 3px #a6c8ff88;
  z-index: 2;
}
.del-btn {
  min-width: 44px;
  min-height: 44px;
  border-radius: 50%;
  background: none;
  transition: background .12s, color .13s, transform .11s;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: 9px;
}
.del-btn:active { transform: scale(0.91) rotate(-14deg); background: #ffe6e8; }
.del-btn:focus-visible { box-shadow: 0 0 0 3px #ffb1bc66; }

input[type="number"]:focus, input[type="text"]:focus, textarea:focus {
  outline: 2.5px solid #4d75ee;
  background: #e6f0ff;
  transition: background .16s, outline .11s;
}

.user-block input[type="number"]:active, .user-block input[type="text"]:active {
  background: #f0f6ff;
}
.user-block .confirm-btn:active {
  background: var(--color-accent-light);
  color: var(--color-primary-dark);
}

/* --- Анимации появления карточки, плавный скролл --- */
@keyframes fadeInCard {
  from { opacity: 0; transform: translateY(13px);}
  to { opacity: 1; transform: translateY(0);}
}
.movie {
  animation: fadeInCard .26s;
  scroll-margin-top: 96px;
}

/* --- Всплывающий snackbar/toast для успеха/ошибки --- */
.toast {
  position: fixed;
  left: 50%;
  bottom: 74px;
  transform: translateX(-50%);
  background: #fff;
  border-radius: 14px;
  color: var(--color-text);
  font-weight: 500;
  font-size: 15px;
  padding: 10px 24px;
  box-shadow: 0 7px 32px #5e81f43a;
  opacity: 0.97;
  z-index: 9999;
  animation: fadeInCard .14s;
}

/* --- Скелетон (loading state, если нужно) --- */
.skeleton {
  background: linear-gradient(90deg,#e3e6ef 30%,#f6f8fa 60%,#e3e6ef 90%);
  border-radius: 8px;
  min-height: 24px;
  width: 100%;
  animation: loadingSkeleton 1.1s infinite linear;
}
@keyframes loadingSkeleton {
  0% { background-position: -200px 0;}
  100% { background-position: 200px 0;}
}

/* --- Prefers-reduced-motion: отключить анимации, если пользователь просит --- */
@media (prefers-reduced-motion: reduce) {
  * { transition: none !important; animation-duration: 0.01s !important; }
}
@media (prefers-color-scheme: dark) {
  :root {
    --color-bg: #181a1e;
    --color-bg-soft: #21262e;
    --color-primary: #7ea6ff;
    --color-primary-dark: #4563ba;
    --color-accent: #fb6b6b;
    --color-accent-light: #ffe3b3;
    --color-neutral: #313849;
    --color-border: #292e3b;
    --color-text: #eaeef7;
    --color-muted: #9498b2;
    --gradient-primary: linear-gradient(98deg, #5067d9 60%, #a77dfa 100%);
    --gradient-accent: linear-gradient(94deg,#fb6b6b 65%,#ffe3b3 100%);
  }

  body, .container {
    background: var(--color-bg) !important;
    color: var(--color-text);
  }
  .container {
    box-shadow: 0 12px 48px #0006;
  }
  .movie {
    background: var(--color-bg-soft);
    border: 1.5px solid var(--color-border);
    box-shadow: 0 2px 18px #181a1e30;
  }
  .user-block, .user-svyat, .user-alena {
    background: #232735 !important;
  }
  .nav-tabs, .filters-search {
    background: transparent;
  }
  .tab, .filter-btn {
    background: var(--color-neutral);
    color: var(--color-primary);
  }
  .tab.active, .filter-btn.active, .random-btn, .add-movie button, .switch-btn {
    background: var(--gradient-primary) !important;
    color: #fff !important;
  }
  .random-btn { box-shadow: 0 4px 16px #4257e226;}
  .avg-score {
    background: var(--color-accent-light);
    color: #6d5c00;
  }
  .modal-content, .toast {
    background: #232735 !important;
    color: #eaeef7 !important;
  }
  input, textarea, #movie-search {
    background: #242a36 !important;
    border-color: #293152;
    color: #eaeef7;
  }
  input:focus, textarea:focus, #movie-search:focus {
    border-color: var(--color-primary);
    background: #232b3c;
  }
}
